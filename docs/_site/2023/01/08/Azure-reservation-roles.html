<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Azure reservation roles - Adding Reservation Administrator, reader, and purchaser | John Sun’s notes</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Azure reservation roles - Adding Reservation Administrator, reader, and purchaser" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Starting Feb 20, 2023 - Azure EA enrollments will only be able to be managed within the Azure Portal" />
<meta property="og:description" content="Starting Feb 20, 2023 - Azure EA enrollments will only be able to be managed within the Azure Portal" />
<link rel="canonical" href="http://localhost:4000/2023/01/08/Azure-reservation-roles.html" />
<meta property="og:url" content="http://localhost:4000/2023/01/08/Azure-reservation-roles.html" />
<meta property="og:site_name" content="John Sun’s notes" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-08T00:47:29-08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Azure reservation roles - Adding Reservation Administrator, reader, and purchaser" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-08T00:47:29-08:00","datePublished":"2023-01-08T00:47:29-08:00","description":"Starting Feb 20, 2023 - Azure EA enrollments will only be able to be managed within the Azure Portal","headline":"Azure reservation roles - Adding Reservation Administrator, reader, and purchaser","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/01/08/Azure-reservation-roles.html"},"url":"http://localhost:4000/2023/01/08/Azure-reservation-roles.html"}</script>
<!-- End Jekyll SEO tag -->
<!-- Favicon -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="John Sun&apos;s notes" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">John Sun&#39;s notes</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/resume/">Resume</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Azure reservation roles - Adding Reservation Administrator, reader, and purchaser</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-01-08T00:47:29-08:00" itemprop="datePublished">Jan 8, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Starting Feb 20, 2023 -  Azure EA enrollments will only be able to be managed within the Azure Portal</p>

<p>Feature announced for <a href="https://azure.microsoft.com/en-us/updates/general-availability-reservation-administrator-and-reader-roles-in-azure-portal/">General Availability</a> in August 2, 2022</p>

<p>Having had a bit of a play, here are my notes to summarise - as always please reach out to make any corrections</p>

<h2 id="new-roles-for-reservations">New roles for Reservations</h2>

<p>There are three granular roles to help manage access to Azure reservations:</p>

<ul>
  <li>Reservation Administrator - Directory role assigned at Reservation -&gt; Role Assignment</li>
  <li>Reservation Reader - Directory role assigned at Reservation -&gt; Role Assignment</li>
  <li>Reservation Purchaser - Resource RBAC Permission assigned at resource group, subscription, or management group levels</li>
</ul>

<p>The role of <code class="language-plaintext highlighter-rouge">Reservation Reader</code> and <code class="language-plaintext highlighter-rouge">Reservation Administrator</code> are notable as they allow a user to gain visibility and control over all existing reservations tied to the tenant, instead of needing to grant access to each reservation order retroactively.</p>

<h2 id="understanding-where-reservations-sit-within-azure">Understanding where reservations sit within Azure</h2>

<p>Reservations are a bit of a strange resource type, they don’t follow the usual resource flow of sitting under a subscription.</p>

<p>Instead, the reservation service sits under the tenant as <code class="language-plaintext highlighter-rouge">providers/Microsoft.capacity</code> and do not inherit permissions from a subscription, as they don’t sit under a subscription, RBAC roles of <code class="language-plaintext highlighter-rouge">Owner</code> or <code class="language-plaintext highlighter-rouge">Contributor</code> will not allow you to manage all reservations - though <code class="language-plaintext highlighter-rouge">Owners</code> for a subscription can manage reservations for that particular subscription for which they are an <code class="language-plaintext highlighter-rouge">Owner</code> - the above roles will unlock the ability to see across all reservations within the tenant once assigned.</p>

<h2 id="permissions-required">Permissions required</h2>

<p>As the reservation resource is under the tenant instead of any subscriptions, you will need to be a <code class="language-plaintext highlighter-rouge">Global Administrator</code> and elevate <code class="language-plaintext highlighter-rouge">User Access Administrator</code> privileges to assign these roles, this can be done via:</p>

<p><code class="language-plaintext highlighter-rouge">Azure Active Directory -&gt; properties</code> and select “Yes” for <code class="language-plaintext highlighter-rouge">"Access management for Azure resources"</code></p>

<p>As <code class="language-plaintext highlighter-rouge">Reservation Purchaser</code> is a resource level role, it can be assigned by an <code class="language-plaintext highlighter-rouge">Owner</code> of the resource group, subscription, or management group</p>

<h2 id="assigning-the-roles">Assigning the roles</h2>

<p>In what is a bit of a confusing twist, reservation roles are actually directory roles, but are instead assigned under
<code class="language-plaintext highlighter-rouge">Reservations -&gt; role assignment</code></p>

<p>instead of
<code class="language-plaintext highlighter-rouge">Azure Active Directory -&gt; roles and administrators</code></p>

<p>Hoping this will eventually be unified.</p>

<p><code class="language-plaintext highlighter-rouge">Owners</code> can assign to mangement groups, subscriptions, and resource groups the <code class="language-plaintext highlighter-rouge">Reservation Purchaser role</code>, I believe this is to make scoped reservations), while the <code class="language-plaintext highlighter-rouge">Reservation Administrator</code> and <code class="language-plaintext highlighter-rouge">Reservation Reader</code> roles are directory roles only assignable currently under the Reservation tab by a <code class="language-plaintext highlighter-rouge">Global Administrator</code> with <code class="language-plaintext highlighter-rouge">User Access Administrator</code> elevation activated.</p>

<h2 id="how-about-privileged-identity-management-pim">How about Privileged Identity Management (PIM)?</h2>

<p>As the resource is tied to the tenant, but the assignment is a directory role, there is no apparent direct way to assign a PIM control for Reservation Administrators or Readers as the PIM roles only allow assignment of roles that are grantable within the Azure AD roles page, and does not cover the roles assignable within the Reservation resource.</p>

<p>Working around the problem, I was able to create a Privileged Access Group that is assigned a <code class="language-plaintext highlighter-rouge">Reservation Administrator</code> for our users to temporarily obtain membership to do reservation mangement</p>

<h2 id="existing-reservation-orders">Existing Reservation Orders</h2>

<p>As usual, any <code class="language-plaintext highlighter-rouge">Enterprise Administrator</code> may assign permissions to individual reservation orders to users, and the user will have visibility on that individual item, but these new roles allow for control over a wider scope.</p>

<h2 id="microsoft-documentation">Microsoft Documentation</h2>

<p><a href="https://learn.microsoft.com/en-us/azure/cost-management-billing/reservations/view-reservations">Permissions to view and manage Azure reservations</a></p>

<p><a href="https://learn.microsoft.com/en-us/azure/cost-management-billing/reservations/prepare-buy-reservation?toc=%2Fazure%2Fcost-management-billing%2Freservations%2Ftoc.json">Buying Reservations</a></p>

<p><a href="https://learn.microsoft.com/en-us/azure/cost-management-billing/manage/direct-ea-administration">EA Administration guide</a></p>


  </div><a class="u-url" href="/2023/01/08/Azure-reservation-roles.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">John Sun&#39;s notes</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">John Sun&#39;s notes</li><li><a class="u-email" href="mailto:johnsunjohn@msn.com">johnsunjohn@msn.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/rawpatty"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">rawpatty</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A collection of notes from experience working across Microsoft technologies</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
